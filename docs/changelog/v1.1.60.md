# v1.1.60：Read 工具大增强

**发布日期**：2026年2月12日

---

## 一句话总结

这次更新 **大幅增强 Read 工具**，支持读取整个目录、行号从 1 开始更直观，同时支持自定义 API URL、Venice 模型自动变体。

---

## 新功能：Read 工具读取目录

### 这次更新了什么？

Read 工具现在可以 **读取整个目录的内容**，而不只是单个文件。

### 如何使用？

在对话中提到目录路径时，OpenCode 会自动读取目录下的文件列表。

### 好处是什么？

- 更方便地了解项目结构
- 不需要先 ls 再逐个读取文件
- AI 能更快理解整个目录的组织方式

---

## 改进：Read 工具行号从 1 开始

### 之前的问题

Read 工具的 offset 参数从 0 开始计数，但显示的行号是 1 开始，容易混淆。

### 现在的情况

offset 参数现在 **从 1 开始**，与显示的行号一致，不再混淆。

### 示例

```
# 想从第 10 行开始读取
# 之前：offset=9
# 现在：offset=10
```

---

## 新功能：自定义模型 API URL

### 这次更新了什么？

现在可以 **为每个模型单独配置 API URL**，不用全局设置。

### 应用场景

- 使用模型中转服务
- 企业内部部署的 API
- 不同模型使用不同的 endpoint

### 如何配置？

在配置文件中为特定模型设置：

```json
{
  "models": {
    "my-custom-model": {
      "api_url": "https://your-api.example.com/v1"
    }
  }
}
```

---

## 新功能：Venice 模型自动变体

### 这次更新了什么？

使用 Venice 模型时，OpenCode 会自动生成常用变体，更方便使用。

---

## 新功能：SDK 结构化输出

### 这次更新了什么？

OpenCode SDK 现在支持 **Claude Agent SDK 风格的结构化输出**，更容易集成到其他系统。

---

## 改进：MCP 工具列表性能

使用 Promise.all 并行获取 MCP 工具列表，启动速度更快。

---

## 新功能：TUI 隐藏会话头

### 这次更新了什么？

TUI 中可以 **切换隐藏会话头部**，获得更多内容显示空间。

---

## 改进：Windows 输入处理

使用 FFI 解决 Windows 上的原始输入和 Ctrl+C 处理问题，体验更好。

---

## 要不要升级？

| 情况 | 建议 |
|------|------|
| 需要读取目录 | ✅ 升级 |
| 使用自定义 API | ✅ 升级 |
| Windows 用户 | ✅ 升级 |
| 用得好好的 | 可以等下次 |

**升级命令**：

```bash
opencode upgrade
```

---

## 技术细节（可跳过）

<details>
<summary>点击展开完整更新列表</summary>

### Core（核心）

- 支持 Claude Agent SDK 风格的结构化输出
- 支持每个模型自定义 API URL
- Venice 模型自动变体生成
- 使用 Promise.all 并行获取 MCP 工具列表
- 升级 OpenTUI 到 0.1.79
- 改进压缩检查逻辑
- Read 工具 offset 改为 1 开始计数
- Read 工具支持读取目录

### TUI（终端界面）

- 使用 FFI 解决 Windows 原始输入和 Ctrl+C 问题
- 添加切换隐藏会话头部的功能

### Desktop（桌面应用）

- 在不安全的浏览器上下文中保护 randomUUID
- 修复工作区重置功能

### 社区贡献

- @K-Mistele：支持 Claude Agent SDK 风格结构化输出
- @dpuyosa：Venice 模型自动变体生成
- @kitlangton：TUI 隐藏会话头部
- @Hona：Windows FFI 输入处理
- @neriousy：修复工作区重置

</details>

---

[← 返回更新日志](./index.md)
