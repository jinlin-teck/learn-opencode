# v1.1.15：服务器安全升级

**发布日期**：2026年1月12日

---

## 一句话总结

这次更新**强化了服务器密码认证机制**，同时优化了 TUI 界面体验，修复了自动补全的退格问题。

---

## 改进：服务器密码认证

### 这次更新了什么？

环境变量从 `OPENCODE_PASSWORD` 重命名为 `OPENCODE_SERVER_PASSWORD`，命名更清晰，同时增强了服务器安全性。

### 这对我有什么影响？

如果你使用远程模式连接 OpenCode 服务器，需要更新环境变量名称：

**之前**：
```bash
export OPENCODE_PASSWORD=your_password
```

**现在**：
```bash
export OPENCODE_SERVER_PASSWORD=your_password
```

### 其他安全改进

- HTTP 异常处理顺序优化，避免错误被错误类型掩盖
- 内置插件安装失败时的错误处理改进
- 通配符权限现在可以同时匹配带参数和不带参数的命令

---

## 改进：TUI 界面优化

### 提示显示重新设计

主屏幕的提示信息展示方式全新设计，更加美观。

### 修复：切换会话时的误提交

**之前的问题**：在切换会话时，有时会意外提交当前正在输入的内容。

**现在**：切换会话时不再触发提交，你的输入内容会保持不变。

### 修复：自动补全退格问题

**之前的问题**：在自动补全菜单打开时，按退格删除空格后，菜单会意外重新打开。

**现在**：退格删除空格后，自动补全菜单不再意外弹出。

### 修复：布局跳动

切换提示显示时，界面不再出现跳动。

---

## 桌面版更新

- **服务器检测优化**：改进了服务器检测和连接逻辑
- **AppImage 暂时禁用**：Linux AppImage 构建暂时关闭

---

## 要不要升级？

| 情况 | 建议 |
|------|------|
| 使用远程模式，配置了 `OPENCODE_PASSWORD` | ✅ 升级并更新环境变量 |
| 遇到过自动补全乱弹的问题 | ✅ 升级 |
| 遇到过切换会话误提交 | ✅ 升级 |
| 用得好好的 | 可以等下次 |

**升级命令**：

```bash
opencode upgrade
```

---

## 技术细节（可跳过）

<details>
<summary>点击展开完整更新列表</summary>

### Core（核心）

- 重命名 `OPENCODE_PASSWORD` 为 `OPENCODE_SERVER_PASSWORD`
- 修复 HTTP 异常处理顺序，防止 NamedError 掩盖 HTTP 异常
- 添加密码认证，改进服务器安全
- 改进内置插件安装失败的错误处理
- 通配符权限现在可以同时匹配带参数和不带参数的命令
- 修复标题生成时的模型选择，使用用户选择的模型

### TUI（终端界面）

- 切换提示显示时防止布局跳动 (@R44VC0RP)
- 添加变体切换提示
- 修复退格删除空格后自动补全重新打开的问题 (@Raviguntakala)
- 重命名 kvStore 为 store
- 重新设计主屏幕提示显示
- 移除更新完成的 toast 通知

### Desktop（桌面版）

- 禁用 AppImage 构建 (@Brendonovich)
- 改进服务器检测和连接逻辑 (@Brendonovich)
- 在 AppInterface 内部解析 defaultServerUrl (@Brendonovich)

### 社区贡献

- @Brendonovich：桌面端服务器连接优化（3 个 PR）
- @shubh73：文档拼写修复
- @jerome-benoit：Nix 可选依赖平台过滤
- @Raviguntakala：自动补全退格修复
- @dbpolito：桌面端消息徽章优化
- @kdcokenny：权限规则文档修复
- @R44VC0RP：TUI 布局跳动修复

</details>

---

[← 返回更新日志](./index.md)
